<!DOCTYPE html>
<html lang="en">
<head>
    <title>Survey Embed</title>
    <!-- Load jQuery first -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Load SurveyJS libraries -->
    <script src="https://unpkg.com/survey-core/survey.core.min.js"></script>
    <script src="https://unpkg.com/survey-jquery/survey.jquery.min.js"></script>
    <link href="https://unpkg.com/survey-core/defaultV2.min.css" rel="stylesheet">
    <style>
        #surveyContainer {
            width: 100%;
            height: auto;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div id="surveyContainer"></div>

    <script>
        // Define the survey JSON
        const surveyJSON = {
            "title": "HRM Training",
            "logoPosition": "right",
            "pages": [
                {
                    "name": "page1",
                    "elements": [
                        {
                            "type": "ranking",
                            "name": "question1",
                            "title": "Rank the following statements from 1 to 18 based on how well they describe your behavior as a Human resource manager.",
                            "isRequired": true,
                            "choices": [
                                {
                                    "value": "Item 1",
                                    "text": "I am dedicated to fostering a culture of continuous improvement and accountability."
                                },
                                {
                                    "value": "Item 2",
                                    "text": "I am committed to promoting social sustainability within our organization and the broader community."
                                },
                                {
                                    "value": "Item 3",
                                    "text": "I am committed to the continuous growth and development of our employees."
                                },
                                {
                                    "value": "Item 4",
                                    "text": "I am dedicated to fostering a highly engaged workforce."
                                }
                            ]
                        }
                    ]
                }
            ]
        };

        // Initialize the Survey
        const survey = new Survey.Model(surveyJSON);

        // Event handler on survey completion
        survey.onComplete.add(function (sender) {
            const surveyData = sender.data;

            fetch('https://script.google.com/macros/s/AKfycbyq-nDoPyF6av3B2itO0RE4YNwHoe5fllefAl4KPALx5V7OmUAwOkp4VRVGGXfDGa88wA/exec', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'  // This will be allowed now
            },
            body: JSON.stringify(surveyData)
        })
            .then(() => console.log("Survey data sent successfully"))
            .catch(error => console.error("Error:", error));
        });

        // Render the Survey in the HTML container
        $(document).ready(function() {
            $("#surveyContainer").Survey({ model: survey });
        });
    </script>
</body>
</html>
